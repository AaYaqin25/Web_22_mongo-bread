<%- include('./partials/header')%>
  <div class="container">
    <div class="head">
      <h1>BREAD(Browse, Read, Edit, Add, Delete</h1>
      <h2>Filters</h2>
    </div>
  </div>
  <br>
  <form action="" method="get">
    <input type="hidden" name="page" value="1">
    <input type="hidden" name="sortBy" value="_id">
    <input type="hidden" name="sortMode" value="asc">
    <div class="container">

      <div class="row">
        <input class="form-check-input" type="checkbox" name="idch" id="idch" >
        <label for="id" class="col-1">ID</label>
        <div class="col-sm-5">
          <input type="text" class="form-control" name="id" id="id" value="<%= query._id%>">
        </div>
      </div>
      <br>
      <div class="row">
        <input class="form-check-input" type="checkbox" name="stringch" id="stringch">
        <label for="string" class="col-sm-1">String</label>
        <div class="col-sm-5">
          <input type="text" class="form-control" name="string" id="string" value="<%= query.string%>">
        </div>
      </div>
      <br>
      <div class="row">
        <input class="form-check-input" type="checkbox" name="integerch" id="integerch">
        <label for="integer" class="col-sm-1">Integer</label>
        <div class="col-sm-5">
          <input type="text" class="form-control" name="integer" id="integer" value="<%= query.integer%>">
        </div>
      </div>
      <br>
      <div class="row">
        <input class="form-check-input" type="checkbox" name="floatch" id="floatch">
        <label for="float" class="col-sm-1">Float</label>
        <div class="col-sm-5">
          <input type="text" class="form-control" name="float" id="float" value="<%= query.float%>">
        </div>
      </div>
      <br>
      <div class="row">
        <input class="form-check-input" type="checkbox" name="datech" id="datech">
        <label for="date" class="col-sm-1">Date</label>
        <div class="col-sm-3">
          <input type="date" class="form-control" name="startdate" id="startdate" value="<%= query.startdate%>">
          <span>to</span>
          <input type="date" class="form-control" name="enddate" id="enddate" value="<%= query.enddate%>">
        </div>
      </div>
      <br>
      <div class="row">
        <input class="form-check-input" type="checkbox" name="booleanch" id="booleanch">
        <label for="boolean" class="col-sm-1">Boolean</label>
        <div class="col-sm-5">
          <select class="form-select" aria-label="Default select example" name="boolean" id="boolean">
            <option selected>Choose the boolean</option>
            <option value="true">true</option>
            <option value="false">false</option>
          </select>
        </div>
      </div>
      <br>
      <button type="submit" class="btn btn-primary"><i class="fa-sharp fa-solid fa-magnifying-glass"></i> Search</button>
      <a href="/" class="btn btn-warning"><i class="fa-solid fa-arrow-rotate-left"></i> Reset</a>
      <hr>
    </div>
  </form>
  <br>
  <div class="container">
    <table class="table table-striped">
      <thead>
        <tr>
          <th scope="col">
            <a href="<%= url.replace(`sortBy=${query.sortBy}`, `sortBy=_id`).replace(`sortMode=${query.sortMode}`, `sortMode=${query.sortMode == 'asc' ? 'desc' : 'asc'}`)%>">
              <i class="fa-solid fa-<%= query.sortBy == '_id' ? query.sortMode == 'asc' ? 'sort-up' : 'sort-down' : 'sort'%>"></i> ID
            </a>
          </th>
          <th scope="col">
            <a href="<%= url.replace(`sortBy=${query.sortBy}`, `sortBy=string`).replace(`sortMode=${query.sortMode}`, `sortMode=${query.sortMode == 'asc' ? 'desc' : 'asc'}`)%>">
              <i class="fa-solid fa-<%= query.sortBy == 'string' ? query.sortMode == 'asc' ? 'sort-up' : 'sort-down' : 'sort'%>"></i> ID
            </a>
          </th>
          <th scope="col">
            <a href="<%= url.replace(`sortBy=${query.sortBy}`, `sortBy=integer`).replace(`sortMode=${query.sortMode}`, `sortMode=${query.sortMode == 'asc' ? 'desc' : 'asc'}`)%>">
              <i class="fa-solid fa-<%= query.sortBy == 'integer' ? query.sortMode == 'asc' ? 'sort-up' : 'sort-down' : 'sort'%>"></i> ID
            </a>
          </th>
          <th scope="col">
            <a href="<%= url.replace(`sortBy=${query.sortBy}`, `sortBy=float`).replace(`sortMode=${query.sortMode}`, `sortMode=${query.sortMode == 'asc' ? 'desc' : 'asc'}`)%>">
              <i class="fa-solid fa-<%= query.sortBy == 'float' ? query.sortMode == 'asc' ? 'sort-up' : 'sort-down' : 'sort'%>"></i> ID
            </a>
          </th>
          <th scope="col">
            <a href="<%= url.replace(`sortBy=${query.sortBy}`, `sortBy=date`).replace(`sortMode=${query.sortMode}`, `sortMode=${query.sortMode == 'asc' ? 'desc' : 'asc'}`)%>">
              <i class="fa-solid fa-<%= query.sortBy == 'date' ? query.sortMode == 'asc' ? 'sort-up' : 'sort-down' : 'sort'%>"></i> ID
            </a>
          </th>
          <th scope="col">Boolean</th>
          <th scope="col">Actions</th>
        </tr>
      </thead>
      <tbody>
        <% read.forEach((item, index)=> {%>
          <tr>
            <td>
              <%= index + offset + 1%>
            </td>
            <td>
              <%= item.string%>
            </td>
            <td>
              <%= item.integer%>
            </td>
            <td>
              <%= item.float%>
            </td>
            <td>
              <%= item.date ? moment(item.date).format('DD MMMM YYYY') : "kosong" %>
            </td>
            <td>
              <%= item.boolean%>
            </td>
            <td>
              <div class="container">
                <a href="/edit/<%= item._id %>" class="btn btn-success"><i class="fa-solid fa-pencil"></i> Edit</a>
                <a href="/delete/<%= item._id %>" onclick="return confirm('Are you sure you want to delete this item?');" class="btn btn-danger"> <i class="fa-solid fa-trash"></i> Delete</a>
              </div>
            </td>
          </tr>
          <% }) %>
    </table>
  </div>
  
  <div class="container">
    <nav aria-label="Page navigation example">
      <ul class="pagination">
        <li class="page-item <%= page == 1 ? 'disabled' : ''%>">
          <a class="page-link" href="<%= url.replace(`page=${page}`, `page=${page - 1}`)%>">Previous</a>
        </li>

        <% for (let i=1; i <=totalPage; i++) { %>
          <li class="page-item <%= i == page ? 'active' : ''%>">
            <a class="page-link" href="<%= url.replace(`page=${page}`, `page=${i}`)%>"><%= i%></a>
          </li>
          <% }%>

            <li class="page-item <%= page == totalPage ? 'disabled' : ''%>">
              <a class="page-link" href="<%= url.replace(`page=${page}`, `page=${page + 1}`)%>">Next</a>
            </li>
      </ul>
    </nav>
  </div>

  <div class="container">
    <a href="/add" class="btn btn-primary"><i class="fa-solid fa-circle-plus"></i> Add</a>
  </div>
  <%- include('./partials/footer')%>